let questionsLength,page,logoImgDataURL;$(document).ready(function(){(page=$(".questionsPage")).addClass("intro"),$("#sidebar").addClass("shrink"),initiateQuestions(),questionsLength=$(".question").length;let e=$("#finishReview");prepareFinishReviewButton(e);let t=$("#download");prepareDownloadButton(t)});let startQuestions=function(){page.removeClass("intro")},prepareDownloadButton=function(e){e[0].addEventListener("click",function(){createPDF()},!1)},prepareFinishReviewButton=function(e){e[0].addEventListener("click",function(){finishReview()},!1)};function toDataURL(e){var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){var e,t=document.createElement("CANVAS"),n=t.getContext("2d");t.height=this.naturalHeight,t.width=this.naturalWidth,n.drawImage(this,0,0),e=t.toDataURL(),console.log("onLoad",e),logoImgDataURL=e},t.src=e}let thisQ,createPDF=function(){let e=$(".question"),t=$(".answer"),n=[],i=1;for(let a in e){let s={question:i+". "+e[a].textContent,answer:t[a].value};if(i++,t[a].value||(s.answer="No answer"),!e[a].textContent)break;n.push(s)}let a=new jsPDF("p","pt","a4"),s=72;a.setFont("georgia","regular"),a.setFontSize(11),a.addImage(logoImgDataURL,"PNG",72,72,146,25),s+=25+11*1.4*3;a.text("Date: XXXX",72,s),s+=11*1.4*2;a.text("Dear Doctor XXXX",72,s),s+=11*1.4*2;let o=a.splitTextToSize("The following are answers to the questions provided by pallidocs.com regarding XXXX'sgoals and wishes during their journey with a serious illness.",451);for(let e in o)a.text(o[e],72,s),s+=11*1.4;s+=11*1.4,a.setFontStyle("bold").text("Healthcare Agent",72,s),s+=11*1.4*2,a.setFontStyle("regular");let l=$(".healthcareAgentInfo");console.log("healthcareinput",l);for(let e=0;e<l.length;e++){let t=l[e],n=t.id+": "+t.value;a.text(n,72,s),s+=11*1.4}s+=11*1.4;let r=a.setFontStyle("italic").setFontSize(9).splitTextToSize("This Health Care Agent shall take effect in the event that a determination is made by my doctor that I lack the capacity to make or to communicate my own health care decisions.",451);a.text(r,72,s),s+=11*1.4*4,a.setFontSize(11);for(let e in n){let t,i="italic",o="regular";t=a.setFontStyle(i).splitTextToSize(n[e].question,451);for(let e in t)s<760||e==t.length-1&&t.length>1?a.text(t[e],72,s):(s=72,a.addPage(),a.text(t[e],72,s)),e==t.length-1?s+=11*1.4*2:s+=11*1.4;t=a.setFontStyle(o).splitTextToSize(n[e].answer,451);for(let e in t)s<760||e==t.length-1&&t.length>1?a.text(t[e],72,s):(s=72,a.addPage(),a.text(t[e],72,s)),e==t.length-1?s+=11*1.4*4:s+=11*1.4}a.save("PallidocsForms.pdf")},initiateQuestions=function(){$("#step1").addClass("show")},qid="1",updateQuestionView=function(e){if((thisQ=$("#step"+qid)).removeClass("show"),"next"==e){if(qid==questionsLength)return void prepareReview();qid<questionsLength&&qid++}else"prev"==e&&qid>1&&qid--;let t=$("#nextButton")[0];t.innerHTML=qid==questionsLength?"Review":"Next",setTimeout(function(){$("#step"+qid).addClass("show")},600)},updateAskFirst=function(e){thisQ=$("#step"+qid),"yes"==e&&thisQ.removeClass("showAskFirst"),"no"==e&&(thisQ.addClass("noClicked"),setTimeout(function(){thisQ.removeClass("noClicked"),updateQuestionView("next")},3e3))},prepareReview=function(){page.addClass("finalReview");let e=$(".answer"),t=$(".reviewA"),n=$(".reviewQ"),i=$(".reviewStep");for(let a=0;a<t.length;a++)e[a].value&&e[a].value.length?t[a].prepend(e[a].value):(n[a].innerHTML="Skipped",$(i[a]).addClass("skipped"));toDataURL("assets/logo_1_dark.png")},returnToAnswer=function(e){page.removeClass("finalReview"),qid=e,updateQuestionView()},finishReview=function(){page.removeClass("finalReview"),page.addClass("healthcareAgentReview")};