const margin=72,endMargin=760,width=595-2*margin;let verticalOffset=margin,fontSize=11;const lineHeight=1.4*fontSize,logoImgPath="assets/logo1_dark_print.png";let logoImgDataUrl,createPDF=function(){let e=new jsPDF("p","pt","a4");e.setFont("georgia","regular"),e.setFontSize(fontSize),printLogoImg(e),skipLine(3);let t="Date: "+getDate();e.text(t,margin,verticalOffset),skipLine(2);let i="Dear "+$("#doctorName")[0].value+",";e.text(i,margin,verticalOffset),skipLine(2),printHeadline(e),skipLine(2),printHealthcareAgentInfo(e),skipLine(4),e.setFontSize(fontSize),printResponses(e),skipLine(4),verticalOffset>400&&(e.addPage(),verticalOffset=margin),printSigningArea(e),e.save("PallidocsForms.pdf")};function printLogoImg(e){let t=margin;e.addImage(logoImgDataUrl,"PNG",227.5,t,140,30),verticalOffset+=30}function printHeadline(e){let t="The following are answers to the questions provided by pallidocs.com regarding "+$("#yourName")[0].value+"'s goals and wishes during their journey with a serious illness.",i=e.splitTextToSize(t,width);for(let t in i)e.text(i[t],margin,verticalOffset),skipLine()}function printHealthcareAgentInfo(e){let t=$(".healthcareAgentInfo");e.setFontStyle("bold").text("Healthcare Agent:",margin,verticalOffset),skipLine(),e.setFontStyle("regular");for(let i=0;i<t.length;i++){let n=t[i],a=n.id+": "+n.value;e.text(a,margin,verticalOffset),skipLine()}skipLine();let i=e.setFontStyle("italic").setFontSize(9).splitTextToSize("This Health Care Agent shall take effect in the event that a determination is made by my doctor that I lack the capacity to make or to communicate my own health care decisions.",width);e.text(i,margin,verticalOffset)}function printResponses(e){let t=formatResponses($(".question"),$(".answer"));for(let i in t){const n="italic",a="regular";let r;r=e.setFontStyle(n).splitTextToSize(t[i].question,width);for(let t in r)verticalOffset<endMargin||t==r.length-1&&r.length>1?e.text(r[t],margin,verticalOffset):(verticalOffset=margin,e.addPage(),e.text(r[t],margin,verticalOffset)),t==r.length-1?skipLine(2):skipLine();r=e.setFontStyle(a).splitTextToSize(t[i].answer,width);for(let t in r){let i=t==r.length-1&&r.length>1;verticalOffset<endMargin||i?e.text(r[t],margin,verticalOffset):(verticalOffset=margin,e.addPage(),e.text(r[t],margin,verticalOffset)),t==r.length-1?skipLine(4):skipLine()}}}function printSigningArea(e){let t=$("#yourName")[0].value;e.text("Please upload this letter into my medical records to have as a guide throughout my journey.",margin,verticalOffset),skipLine(2),e.text("Sincerely,",margin,verticalOffset),skipLine(),e.text(t,margin,verticalOffset),skipLine(3),e.text("Signature ______________________________________          Date _________________________",margin,verticalOffset)}function getDate(){let e=new Date,t=e.getDate(),i=e.getMonth()+1;return t<10&&(t="0"+t),i<10&&(i="0"+i),i+"/"+t+"/"+e.getFullYear()}function skipLine(e){verticalOffset+=lineHeight*(e||1)}function createLogoDataUrl(e){let t=new Image;t.crossOrigin="Anonymous",t.onload=function(){let e=document.createElement("CANVAS"),t=e.getContext("2d");e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0),logoImgDataUrl=e.toDataURL()},t.src=e}function formatResponses(e,t){let i=[],n=1;for(let a in e){let r={question:n+". "+e[a].innerText,answer:t[a].value};if(n++,t[a].value||(r.answer="No answer"),!e[a].innerText)break;i.push(r)}return i}$(document).ready(()=>{createLogoDataUrl(logoImgPath)});