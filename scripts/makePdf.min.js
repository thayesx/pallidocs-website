const margin=72,endMargin=760,width=595-2*margin;let verticalOffset=margin,fontSize=11;const lineHeight=1.4*fontSize,logoImgPath="assets/logo1_dark_print.png";let logoImgDataUrl,createPDF=function(){let e=$(".question"),t=$(".answer"),i=$("#yourName")[0].value,a=$("#doctorName")[0].value,n=$(".healthcareAgentInfo"),r=formatUserInputData(e,t),l=new jsPDF("p","pt","a4");l.setFont("georgia","regular"),l.setFontSize(fontSize),addLogoImage(l),skipLine(3);let s="Date: "+getDate();l.text(s,margin,verticalOffset),skipLine(2);let o="Dear "+a+",";l.text(o,margin,verticalOffset),skipLine(2);let g="The following are answers to the questions provided by pallidocs.com regarding "+i+"'s goals and wishes during their journey with a serious illness.",f=l.splitTextToSize(g,width);for(let e in f)l.text(f[e],margin,verticalOffset),skipLine();skipLine(2),l.setFontStyle("bold").text("Healthcare Agent:",margin,verticalOffset),skipLine(),l.setFontStyle("regular");for(let e=0;e<n.length;e++){let t=n[e],i=t.id+": "+t.value;l.text(i,margin,verticalOffset),skipLine()}skipLine();let _=l.setFontStyle("italic").setFontSize(9).splitTextToSize("This Health Care Agent shall take effect in the event that a determination is made by my doctor that I lack the capacity to make or to communicate my own health care decisions.",width);l.text(_,margin,verticalOffset),skipLine(4),l.setFontSize(fontSize);for(let e in r){const t="italic",i="regular";let a;a=l.setFontStyle(t).splitTextToSize(r[e].question,width);for(let e in a)verticalOffset<760||e==a.length-1&&a.length>1?l.text(a[e],margin,verticalOffset):(verticalOffset=margin,l.addPage(),l.text(a[e],margin,verticalOffset)),e==a.length-1?skipLine(2):skipLine();a=l.setFontStyle(i).splitTextToSize(r[e].answer,width);for(let e in a){let t=e==a.length-1&&a.length>1;verticalOffset<760||t?l.text(a[e],margin,verticalOffset):(verticalOffset=margin,l.addPage(),l.text(a[e],margin,verticalOffset)),e==a.length-1?skipLine(4):skipLine()}}skipLine(4),verticalOffset>400&&(l.addPage(),verticalOffset=margin),l.text("Please upload this letter into my medical records to have as a guide throughout my journey.",margin,verticalOffset),skipLine(2),l.text("Sincerely,",margin,verticalOffset),skipLine(),l.text(i,margin,verticalOffset),skipLine(3),l.text("Signature ______________________________________          Date _________________________",margin,verticalOffset),l.save("PallidocsForms.pdf")};function addLogoImg(e){let t=margin;e.addImage(logoImgDataUrl,"PNG",227.5,t,140,30),verticalOffset+=30}function getDate(){let e=new Date,t=e.getDate(),i=e.getMonth()+1;return t<10&&(t="0"+t),i<10&&(i="0"+i),i+"/"+t+"/"+e.getFullYear()}function skipLine(e){verticalOffset+=lineHeight*(e||1)}function createLogoDataUrl(e){let t=new Image;t.crossOrigin="Anonymous",t.onload=function(){let e=document.createElement("CANVAS"),t=e.getContext("2d");e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0),logoImgDataUrl=e.toDataURL()},t.src=e}function formatUserInputData(e,t){let i=[],a=1;for(let n in e){let r={question:a+". "+e[n].innerText,answer:t[n].value};if(a++,t[n].value||(r.answer="No answer"),!e[n].innerText)break;i.push(r)}return i}$(document).ready(()=>{createLogoDataUrl(logoImgPath)});